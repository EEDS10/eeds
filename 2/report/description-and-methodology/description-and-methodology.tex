
This section describes the sound program, and details how it was developed. This section covers procedure, setup and configuration, tools and program details.

need to include a bit about the Makefile here


\section{Description}

The solution program plays sound effects and music, and is controlled by the eight buttons on the STK1000.
The LEDs are used to indicate which sound is playing.

When the program is started, the board is in idle mode, ready to react to button presses.
Pressing any of the buttons SW0-SW3 plays a piece of music, which loops until another sound is selected.
Pressing any of the buttons SW4-SW6 plays a sound effect, which is not looped.
Pressing SW7 stops all playback.

\subsection{Sound effects}

The sound effects are generatively composed by wrapping a generator signal in a configurable ADSR volume envelope.
TODO: talk about ADSR.
The available generator signals in the program are NOISE, SAWTOOTH and SQUARE.

TODO: talk about NISE, SAWTOOTH and SQUARE, with photos.

\subsubsection{Sound effect: Explosion}

'Explosion' is a NOISE-based sound effect with the following ADSR envelope: XXX.
Length: XXX.
'Explosion' can be triggered by pressing SW6.
TODO: add photo

\subsubsection{Sound effect: Air horn}
'Air horn' is a SAWTOOTH-based sound effect with the following ADSR envelope: XXX.
Length: XXX.
'Air horn' can be triggered by pressing SW5.
TODO: add photo

\subsubsection{Sound effect: Teleport}
'Teleport' is a SQUARE-based sound effect with the following ADSR envelope: XXX.
Length: XXX.
'Teleport' can be triggered by pressing SW4.
TODO: add photo


\subsection{Music}

The pieces of music are played by the MOD player.

Pressing SW3 triggers Dizzy/CNCD's Tuulenvire.
It is a 2:09 long 808KB composition in the ambient genre, featuring piano and accordion, amongst other instruments.
This composition was chosen to demonstrate how careful composing can render realistic compositions with a relatively small memory footprint.
It uses 25 samples.

Pressing SW2 triggers Romeo Knight's Boesendorfer P. S. S.
It is a 3:22 long 211KB solo piano composition, chosen to illustrate the possibilities enabled by a hybrid generative/recorded approach.
It uses 9 samples.

Pressing SW1 triggers a tweaked version of H0ffmann's Drop The Panic, chosen because it sounds cool.
It is a 4:05 long 702KB ``glitch-hop'' composition.
It uses 31 samples.
The composition was tweaked to decrease critical cache misses by the MOD player during playback on the STK1000.

Pressing SW0 triggers Maktone's Bacongrytor.
It is a 15Kb endless loop chiptune-style composition, chosen to demonstrate the compactness of the MOD format, and therefore its aptfulness for use on microcontrollers.
It uses 7 samples.


Development of the program

list of what we did:

* Board was set up w/ jumpers and such
* Leds and buttons were hooked up in hardware
* Leds and buttons were hooked up in software
* Code was split into separate files
* Audio was hooked up with apropriate settings
* Sound was tested to work using random noise


the following two groups of bullet points happened in parallel:

* a C sound effect synth inspired by sfxr was prototyped on a PC
* the synth was ported to avr32
* the synth was developed further on the avr32
* the synth was used in the stk1000 program to play various sound effects

* a C MOD player library + python tools inspired by amiga trackers were developed on a PC
* the library was tested on the avr32 and needed a great deal of optimization
* a great deal of optimization occurred 
* the library was used in the stk1000 program to play selected mods


finally:

* the actual main program flow was decided upon and written, hooking button and led behaviour together with sound effects and music



Configuration

We can reference our previous report here, so that we don't have to write so much.


Programming environment

JTAGICE
We can reference our previous report here, so that we don't have to write so much.

GNU Debugger
since last time:
* discovered tui mode: looks nice, breaks the makefile

Make
we can reference.

Other tools
* OpenMPT was used to examine MOD files for libmodam
* vim
* git
* github
* latex
* avr32 toolchain

Setting up the LEDs
Setting up the buttons
Setting up the audio


Program flow

* main program
* synth
* libmodam

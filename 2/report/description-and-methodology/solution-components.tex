The solution consists of three separate components. This section describes each of the three.

\subsection{main program}

The main program is the C program which runs on the STK1000.
It interfaces with the hardware, and administers the user interface and main program logic.

\subsection{synth}

The synthesizer consists of two parts, a wave generator and an ADSR (attack-decay-sustain-release) envelope.
The wave generator can generate sawtooth and square waves with arbitrary frequencies, as well as random noise.
The ADSR envelope modifies the output volume of the generated signal depending on which part of the sound we're in - attack, decay, sustain or release.

At the start of the sound, during the attack, the volume is gradually increased from complete silence to full volume.
The decay part decreases the volume gradually to a given sustain level, which will be kept constant for the sustain part of the sound.
Finally, the sounds fade out from the sustain level to complete silence in the release part.

\subsection{libmodam}

Libmodam is the name of the MOD file parser and player written for this assignment.
It is written as a portable, cross-platform C library.
It has been tested on avr32 and on x86.

Libmodam is statically linked in the main solution program.

Libmodam includes a python utility script for platforms without filesystems.
Normally, to use libmodam, a programmer must read a MOD file to a byte buffer, and pass the buffer to libmodam, as it is done in the sample usage program test.c.
This is sadly impossible in environments without a file system.
The python script solves this by reading arbitrary files and converting them to C-code declaring large static const char* arrays representing those files.
For most platforms, this means that the files will be bundled with the executable in the .text section, making them read only.

By the programmer using libmodam, two main functions must be called repeatedly to generate output.
One of these functions is \texttt{MOD\_Player\_play(...)}.
This function returns a single sample of output, and must be called \texttt{sample rate} times per second for real time playback.
The other function is \texttt{MOD\_Player\_step(...)}, and advances logical state, such as which notes should be playing and what effect should be applied.
This function should be called no less that 50 times per second for real time playback.

These two driving functions are split up like this to minimize and keep constant the time spent generating the next output sample, to make libmodam more real-time-friendly.

Libmodam implements support for \texttt{M.K.} type MODs.
A subset of the playback effects from \texttt{M.K.} have been implemented.
Which effects to implement was chosen so that the most popular and often used effects were prioritized.
A list of the effects in \texttt{M.K.}, and their implementation status in libmodam can be found in \ref{libmodam-feats}.

\begin{table}[H]
	\centering
    \begin{tabular}{|l|l|}
        \hline
        Effect & Implemented? \\
        \hline
        \hline
        Arpeggio & implemented \\
        \hline
        Slide up & implemented \\
        \hline
        Slide down & implemented \\
        \hline
        Slide to note & implemented \\
        \hline
        Vibrato & not implemented* \\
        \hline
        Continue slide to note and volume slide & implemented \\
        \hline
        Tremolo & not implemented \\
        \hline
        Unused & implemented \\
        \hline
        Set sample offset & not implemented \\
        \hline
        Volume slide & implemented \\
        \hline
        Position jump & implemented \\
        \hline
        Set volume & implemented \\
        \hline
        Pattern break & implemented \\
        \hline
        Set filter on/off & not implemented \\
        \hline
        Fineslide up & not implemented \\
        \hline
        Fineslide down & not implemented \\
        \hline
        Set glissando on/off & not implemented \\
        \hline
        Set vibrato waveform & not implemented \\
        \hline
        Set finetune value & not implemented \\
        \hline
        Loop pattern & implemented \\
        \hline
        Set tremolo waveform & not implemented \\
        \hline
        Extended unused & implemented \\
        \hline
        Retrigger sample & not implemented \\
        \hline
        Fine volume slide up & implemented \\
        \hline
        Fine volume slide down & implemented \\
        \hline
        Cut sample & implemented \\
        \hline
        Delay sample & not implemented \\
        \hline
        Delay pattern & not implemented \\
        \hline
        Invert loop & not implemented \\
        \hline
        Set speed & implemented
    \end{tabular}
    \label{libmodam-feats}
\end{table}
*was implemented at one point, but was later removed for performance reasons
